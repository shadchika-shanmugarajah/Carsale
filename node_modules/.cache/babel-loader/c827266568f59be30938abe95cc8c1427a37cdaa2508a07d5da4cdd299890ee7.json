{"ast":null,"code":"// API configuration and utilities\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n\n// Helper to get auth token from localStorage\nexport const getAuthToken = () => {\n  return localStorage.getItem('authToken');\n};\n\n// Helper to set auth token\nexport const setAuthToken = token => {\n  localStorage.setItem('authToken', token);\n};\n\n// Helper to remove auth token\nexport const removeAuthToken = () => {\n  localStorage.removeItem('authToken');\n  localStorage.removeItem('username');\n  localStorage.removeItem('isLoggedIn');\n};\n\n// Generic API call function\nasync function apiCall(endpoint, options = {}) {\n  const token = getAuthToken();\n  const headers = {\n    'Content-Type': 'application/json',\n    ...(options.headers || {})\n  };\n\n  // Add auth token if available\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n  const config = {\n    ...options,\n    headers\n  };\n  try {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, config);\n\n    // Handle non-JSON responses or errors\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({\n        message: `HTTP error! status: ${response.status}`\n      }));\n      throw new Error(errorData.message || 'API request failed');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('API call error:', error);\n    throw error;\n  }\n}\n\n// Auth API\nexport const authAPI = {\n  login: async (username, password) => {\n    const response = await apiCall('/auth/login', {\n      method: 'POST',\n      body: JSON.stringify({\n        username,\n        password\n      })\n    });\n\n    // Save token and user info\n    if (response.token) {\n      setAuthToken(response.token);\n      localStorage.setItem('username', response.user.username);\n      localStorage.setItem('userId', response.user.id);\n      localStorage.setItem('isLoggedIn', 'true');\n    }\n    return response;\n  },\n  register: async (username, password) => {\n    return await apiCall('/auth/register', {\n      method: 'POST',\n      body: JSON.stringify({\n        username,\n        password\n      })\n    });\n  },\n  logout: () => {\n    removeAuthToken();\n  }\n};\n\n// Expense API\n\nexport const expenseAPI = {\n  getAll: async params => {\n    const queryParams = new URLSearchParams();\n    if (params !== null && params !== void 0 && params.page) queryParams.append('page', params.page.toString());\n    if (params !== null && params !== void 0 && params.limit) queryParams.append('limit', params.limit.toString());\n    if (params !== null && params !== void 0 && params.category) queryParams.append('category', params.category);\n    if (params !== null && params !== void 0 && params.startDate) queryParams.append('startDate', params.startDate);\n    if (params !== null && params !== void 0 && params.endDate) queryParams.append('endDate', params.endDate);\n    const queryString = queryParams.toString();\n    return await apiCall(`/expenses${queryString ? `?${queryString}` : ''}`);\n  },\n  getById: async id => {\n    return await apiCall(`/expenses/${id}`);\n  },\n  create: async expense => {\n    return await apiCall('/expenses', {\n      method: 'POST',\n      body: JSON.stringify(expense)\n    });\n  },\n  update: async (id, expense) => {\n    return await apiCall(`/expenses/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(expense)\n    });\n  },\n  delete: async id => {\n    return await apiCall(`/expenses/${id}`, {\n      method: 'DELETE'\n    });\n  },\n  getStats: async params => {\n    const queryParams = new URLSearchParams();\n    if (params !== null && params !== void 0 && params.startDate) queryParams.append('startDate', params.startDate);\n    if (params !== null && params !== void 0 && params.endDate) queryParams.append('endDate', params.endDate);\n    const queryString = queryParams.toString();\n    return await apiCall(`/expenses/stats/summary${queryString ? `?${queryString}` : ''}`);\n  }\n};\nexport default {\n  auth: authAPI,\n  expenses: expenseAPI\n};","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_URL","getAuthToken","localStorage","getItem","setAuthToken","token","setItem","removeAuthToken","removeItem","apiCall","endpoint","options","headers","config","response","fetch","ok","errorData","json","catch","message","status","Error","error","console","authAPI","login","username","password","method","body","JSON","stringify","user","id","register","logout","expenseAPI","getAll","params","queryParams","URLSearchParams","page","append","toString","limit","category","startDate","endDate","queryString","getById","create","expense","update","delete","getStats","auth","expenses"],"sources":["C:/Users/wnama/OneDrive - Wiley/Desktop/carsale_summa/carsale/src/utils/api.ts"],"sourcesContent":["// API configuration and utilities\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\n\r\n// Helper to get auth token from localStorage\r\nexport const getAuthToken = (): string | null => {\r\n  return localStorage.getItem('authToken');\r\n};\r\n\r\n// Helper to set auth token\r\nexport const setAuthToken = (token: string): void => {\r\n  localStorage.setItem('authToken', token);\r\n};\r\n\r\n// Helper to remove auth token\r\nexport const removeAuthToken = (): void => {\r\n  localStorage.removeItem('authToken');\r\n  localStorage.removeItem('username');\r\n  localStorage.removeItem('isLoggedIn');\r\n};\r\n\r\n// Generic API call function\r\nasync function apiCall<T>(\r\n  endpoint: string,\r\n  options: RequestInit = {}\r\n): Promise<T> {\r\n  const token = getAuthToken();\r\n  \r\n  const headers: Record<string, string> = {\r\n    'Content-Type': 'application/json',\r\n    ...(options.headers as Record<string, string> || {}),\r\n  };\r\n\r\n  // Add auth token if available\r\n  if (token) {\r\n    headers['Authorization'] = `Bearer ${token}`;\r\n  }\r\n\r\n  const config: RequestInit = {\r\n    ...options,\r\n    headers,\r\n  };\r\n\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, config);\r\n    \r\n    // Handle non-JSON responses or errors\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({ \r\n        message: `HTTP error! status: ${response.status}` \r\n      }));\r\n      throw new Error(errorData.message || 'API request failed');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('API call error:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Auth API\r\nexport const authAPI = {\r\n  login: async (username: string, password: string) => {\r\n    const response = await apiCall<{ token: string; user: { id: string; username: string } }>(\r\n      '/auth/login',\r\n      {\r\n        method: 'POST',\r\n        body: JSON.stringify({ username, password }),\r\n      }\r\n    );\r\n    \r\n    // Save token and user info\r\n    if (response.token) {\r\n      setAuthToken(response.token);\r\n      localStorage.setItem('username', response.user.username);\r\n      localStorage.setItem('userId', response.user.id);\r\n      localStorage.setItem('isLoggedIn', 'true');\r\n    }\r\n    \r\n    return response;\r\n  },\r\n\r\n  register: async (username: string, password: string) => {\r\n    return await apiCall<{ message: string; user: { id: string; username: string } }>(\r\n      '/auth/register',\r\n      {\r\n        method: 'POST',\r\n        body: JSON.stringify({ username, password }),\r\n      }\r\n    );\r\n  },\r\n\r\n  logout: () => {\r\n    removeAuthToken();\r\n  },\r\n};\r\n\r\n// Expense API\r\nexport interface Expense {\r\n  _id?: string;\r\n  category: string;\r\n  description: string;\r\n  amount: number;\r\n  date: string;\r\n  currency: 'USD' | 'LKR' | 'EUR' | 'JPY' | string;\r\n  createdBy?: any;\r\n  createdAt?: string;\r\n  updatedAt?: string;\r\n}\r\n\r\nexport interface ExpenseListResponse {\r\n  expenses: Expense[];\r\n  totalPages: number;\r\n  currentPage: number;\r\n  total: number;\r\n}\r\n\r\nexport const expenseAPI = {\r\n  getAll: async (params?: {\r\n    page?: number;\r\n    limit?: number;\r\n    category?: string;\r\n    startDate?: string;\r\n    endDate?: string;\r\n  }): Promise<ExpenseListResponse> => {\r\n    const queryParams = new URLSearchParams();\r\n    if (params?.page) queryParams.append('page', params.page.toString());\r\n    if (params?.limit) queryParams.append('limit', params.limit.toString());\r\n    if (params?.category) queryParams.append('category', params.category);\r\n    if (params?.startDate) queryParams.append('startDate', params.startDate);\r\n    if (params?.endDate) queryParams.append('endDate', params.endDate);\r\n\r\n    const queryString = queryParams.toString();\r\n    return await apiCall<ExpenseListResponse>(\r\n      `/expenses${queryString ? `?${queryString}` : ''}`\r\n    );\r\n  },\r\n\r\n  getById: async (id: string): Promise<{ expense: Expense }> => {\r\n    return await apiCall<{ expense: Expense }>(`/expenses/${id}`);\r\n  },\r\n\r\n  create: async (expense: Omit<Expense, '_id'>): Promise<{ message: string; expense: Expense }> => {\r\n    return await apiCall<{ message: string; expense: Expense }>('/expenses', {\r\n      method: 'POST',\r\n      body: JSON.stringify(expense),\r\n    });\r\n  },\r\n\r\n  update: async (id: string, expense: Partial<Expense>): Promise<{ message: string; expense: Expense }> => {\r\n    return await apiCall<{ message: string; expense: Expense }>(`/expenses/${id}`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(expense),\r\n    });\r\n  },\r\n\r\n  delete: async (id: string): Promise<{ message: string }> => {\r\n    return await apiCall<{ message: string }>(`/expenses/${id}`, {\r\n      method: 'DELETE',\r\n    });\r\n  },\r\n\r\n  getStats: async (params?: {\r\n    startDate?: string;\r\n    endDate?: string;\r\n  }): Promise<{\r\n    summary: {\r\n      totalAmount: number;\r\n      averageAmount: number;\r\n      count: number;\r\n      categories: string[];\r\n    };\r\n    categoryBreakdown: Array<{\r\n      _id: string;\r\n      total: number;\r\n      count: number;\r\n    }>;\r\n  }> => {\r\n    const queryParams = new URLSearchParams();\r\n    if (params?.startDate) queryParams.append('startDate', params.startDate);\r\n    if (params?.endDate) queryParams.append('endDate', params.endDate);\r\n\r\n    const queryString = queryParams.toString();\r\n    return await apiCall(\r\n      `/expenses/stats/summary${queryString ? `?${queryString}` : ''}`\r\n    );\r\n  },\r\n};\r\n\r\nexport default {\r\n  auth: authAPI,\r\n  expenses: expenseAPI,\r\n};\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}